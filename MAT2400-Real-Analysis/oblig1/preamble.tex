\documentclass[11pt]{article}

%-------------------------
% Packages
%-------------------------
\usepackage[a4paper,margin=1in]{geometry}
\usepackage{xcolor}
\usepackage{tikz}
\usepackage[most]{tcolorbox}
\usepackage{amsthm, amsmath, amssymb}
\usepackage{enumitem}
\usepackage{hyperref}
\usepackage[nameinlink,noabbrev]{cleveref}
\usepackage{titling} 
\usepackage{fontspec}
\usepackage{unicode-math}


%-------------------------
% Fonts
%-------------------------
\setmainfont{JetBrains Mono}
\setsansfont{JetBrains Mono}
\setmonofont{JetBrains Mono}


\setmathfont[
    Scale=1.25
]{latinmodern-math.otf}

\setmathfont[
  range=\mathup/{latin, Latin, 0-9},
  range=\mathit/{latin, Latin},
  range=\mathbfit/{latin, Latin},
  Scale=1.5
]{JetBrains Mono Bold} 

\setmathfont[range=\mathbb, Scale=MatchUppercase]{latinmodern-math.otf}

%-------------------------
% Paragraph spacing
%-------------------------
\setlength{\parindent}{0pt}
\setlength{\parskip}{0.7em}


%-------------------------
% Dark mode colors
%-------------------------
\definecolor{bgcolor}{HTML}{333333}
\definecolor{textcolor}{HTML}{FAFAFA}
\definecolor{defcolor}{HTML}{E86873}
\definecolor{thmcolor}{HTML}{0A9396}
\definecolor{lemcolor}{HTML}{94D2BD}
\definecolor{corcolor}{HTML}{9B4AF7}
\definecolor{probcolor}{HTML}{EE9B00}
\definecolor{excolor}{HTML}{21E933}
\definecolor{propcolor}{HTML}{EE9B20}

%-------------------------
% Background and text color
%-------------------------
\pagecolor{bgcolor}
\color{textcolor}

%-------------------------
% Paragraph spacing
%-------------------------
\setlength{\parindent}{0pt}
\setlength{\parskip}{0.7em}

%-------------------------
% Base tcolorbox settings (Removed 'attach title to upper')
%-------------------------
\tcbset{
  enhanced,
  colback=bgcolor,
  colframe=thmcolor,
  coltext=white,
  coltitle=white,
  fonttitle=\bfseries,
  boxrule=0.7pt,
  left=1em,
  right=1em,
  top=0.7em,
  bottom=0.7em,
  before skip=10pt,
  after skip=10pt,
  title after break,
  breakable
}

%-------------------------
% Standard Theorem Environments (using amsthm)
% Syntax: \begin{thm}[Optional Title]\label{thm:label} ...
%-------------------------
\newtheorem{thm}{Theorem}[section]
\newtheorem{defn}{Definition}[section]
\newtheorem{lem}{Lemma}[section]
\newtheorem{cor}{Corollary}[section]
\newtheorem{prob}{Problem}[section]
\newtheorem*{prob*}{Problem}
\newtheorem{ex}{Example}[section]
\newtheorem{prop}{Proposition}[section]

%-------------------------
% Tcolorbox environments (applies style to amsthm environments)
% Removed 'attach title to upper' from all individual settings.
%-------------------------
\tcolorboxenvironment{thm}{
  colframe=thmcolor,
  colback=thmcolor!15!bgcolor,
  fonttitle=\bfseries,
  coltitle=white,
  breakable,
  title after break,
}

\tcolorboxenvironment{defn}{
  colframe=defcolor,
  colback=defcolor!15!bgcolor,
  fonttitle=\bfseries,
  coltitle=white,
  breakable,
  title after break,
}

\tcolorboxenvironment{lem}{
  colframe=lemcolor,
  colback=lemcolor!15!bgcolor,
  fonttitle=\bfseries,
  coltitle=white,
  breakable,
  title after break,
}

\tcolorboxenvironment{cor}{
  colframe=corcolor,
  colback=corcolor!15!bgcolor,
  fonttitle=\bfseries,
  coltitle=white,
  breakable,
  title after break,
}

\tcolorboxenvironment{prob}{
  colframe=probcolor,
  colback=probcolor!15!bgcolor,
  fonttitle=\bfseries,
  coltitle=white,
  breakable,
  title after break,
}

\tcolorboxenvironment{prob*}{
  colframe=probcolor,
  colback=probcolor!15!bgcolor,
  fonttitle=\bfseries,
  coltitle=white,
  breakable,
  title after break,
}

\tcolorboxenvironment{ex}{
  colframe=excolor,
  colback=excolor!15!bgcolor,
  fonttitle=\bfseries,
  coltitle=white,
  breakable,
  title after break,
}

\tcolorboxenvironment{prop}{
    colframe=propcolor, 
    colback=propcolor!15!bgcolor,
    fonttitle=\bfseries,
    coltitle=white,
    breakable,
    title after break
}

%-------------------------
% Cleveref settings (Using short environment names for correct display)
%-------------------------
\crefname{thm}{theorem}{theorems}
\Crefname{thm}{Theorem}{Theorems}

\crefname{defn}{definition}{definitions}
\Crefname{defn}{Definition}{Definitions}

\crefname{lem}{lemma}{lemmas}
\Crefname{lem}{Lemma}{Lemmas}

\crefname{cor}{corollary}{corollaries}
\Crefname{cor}{Corollary}{Corollaries}

\crefname{prob}{problem}{problems}
\Crefname{prob}{Problem}{Problems}

\crefname{ex}{example}{examples}
\Crefname{ex}{Example}{Examples}

\crefname{prop}{proposition}{propositions}
\Crefname{prop}{Proposition}{Propositions}

\crefname{prop*}{proposition}{propositions}
\Crefname{prop*}{Proposition}{Propositions}
